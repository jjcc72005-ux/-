<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zidan Trace | Ø§Ø±Ø³Ù… Ø¨Ø®ÙŠØ§Ù„Ùƒ</title>
<style>
  body {
    margin: 0;
    font-family: "Cairo", sans-serif;
    background: radial-gradient(circle at center, #0d0d0d 40%, #000 100%);
    color: #fff;
    overflow: hidden;
  }

  /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
  #splash {
    position: fixed;
    inset: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: #000;
    z-index: 9999;
    animation: fadeOut 1s ease 3s forwards;
  }
  @keyframes fadeOut { to { opacity: 0; visibility: hidden; } }

  #splash svg {
    width: 120px;
    height: 120px;
    stroke: #00c8ff;
    fill: none;
    stroke-width: 2;
    stroke-dasharray: 500;
    stroke-dashoffset: 500;
    animation: draw 3s ease forwards;
  }

  @keyframes draw {
    to { stroke-dashoffset: 0; }
  }

  #splash h1 {
    margin-top: 20px;
    font-size: 28px;
    color: #00c8ff;
    letter-spacing: 2px;
  }

  /* Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
  #main {
    position: fixed;
    inset: 0;
    background: transparent;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    gap: 20px;
  }

  #startBtn {
    background: #00c8ff;
    color: #000;
    border: none;
    padding: 15px 40px;
    border-radius: 12px;
    font-size: 18px;
    cursor: pointer;
    box-shadow: 0 0 15px #00c8ff77;
    transition: 0.3s;
  }

  #startBtn:hover {
    transform: scale(1.05);
  }

  video {
    width: 100vw;
    height: 100vh;
    object-fit: cover;
    position: fixed;
    top: 0;
    left: 0;
    z-index: -2;
  }

  #overlay {
    position: fixed;
    inset: 0;
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 10;
  }

  #uploadedImg {
    position: absolute;
    max-width: 90%;
    max-height: 80%;
    opacity: 0.5;
    transition: opacity 0.3s ease, transform 0.3s ease;
    border-radius: 12px;
    box-shadow: 0 0 30px #00c8ff44;
  }

  #controls {
    position: fixed;
    bottom: 20px;
    width: 90%;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.6);
    border-radius: 15px;
    padding: 10px;
    display: flex;
    justify-content: space-around;
    align-items: center;
    flex-wrap: wrap;
    gap: 10px;
  }

  input[type="range"] {
    width: 100px;
    accent-color: #00c8ff;
  }

  .btn {
    background: #00c8ff;
    border: none;
    color: #000;
    padding: 10px 18px;
    border-radius: 10px;
    cursor: pointer;
    font-size: 14px;
    transition: 0.3s;
  }

  .btn:hover {
    transform: scale(1.1);
  }

  input[type="file"] {
    display: none;
  }

</style>
</head>
<body>

<!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
<div id="splash">
  <svg viewBox="0 0 100 100">
    <path d="M50 10 Q40 20 30 40 Q50 60 70 40 Q60 20 50 10Z" />
  </svg>
  <h1>Zidan Trace</h1>
</div>

<!-- Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ -->
<video id="camera" autoplay playsinline></video>

<!-- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© -->
<div id="main">
  <button id="startBtn">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø±Ø³Ù… âœï¸</button>
</div>

<!-- Ø·Ø¨Ù‚Ø© Ø§Ù„ØµÙˆØ±Ø© -->
<div id="overlay">
  <img id="uploadedImg" src="" alt="">
  <div id="controls">
    <label class="btn">
      Ø§Ø®ØªØ± ØµÙˆØ±Ø©
      <input type="file" id="fileInput" accept="image/*">
    </label>
    <button class="btn" id="flipBtn">ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§</button>
    <button class="btn" id="lockBtn">Ù‚ÙÙ„ Ø§Ù„ØµÙˆØ±Ø©</button>
    <label>Ø§Ù„Ø´ÙØ§ÙÙŠØ©<input type="range" id="opacityRange" min="0.1" max="1" step="0.05" value="0.5"></label>
    <label>Ø§Ù„Ø­Ø¬Ù…<input type="range" id="sizeRange" min="0.5" max="2" step="0.1" value="1"></label>
  </div>
</div>

<script>
let camera = document.getElementById('camera');
let overlay = document.getElementById('overlay');
let startBtn = document.getElementById('startBtn');
let fileInput = document.getElementById('fileInput');
let uploadedImg = document.getElementById('uploadedImg');
let opacityRange = document.getElementById('opacityRange');
let sizeRange = document.getElementById('sizeRange');
let flipBtn = document.getElementById('flipBtn');
let lockBtn = document.getElementById('lockBtn');

let locked = false;
let usingFrontCamera = false;

async function startCamera() {
  let constraints = { video: { facingMode: usingFrontCamera ? 'user' : 'environment' } };
  try {
    let stream = await navigator.mediaDevices.getUserMedia(constraints);
    camera.srcObject = stream;
  } catch (e) {
    alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§.");
    console.error(e);
  }
}

startBtn.onclick = () => {
  document.getElementById('main').style.display = 'none';
  overlay.style.display = 'flex';
  startCamera();
};

fileInput.onchange = e => {
  let file = e.target.files[0];
  if (file) {
    let reader = new FileReader();
    reader.onload = () => {
      uploadedImg.src = reader.result;
      uploadedImg.style.display = 'block';
    };
    reader.readAsDataURL(file);
  }
};

opacityRange.oninput = e => {
  uploadedImg.style.opacity = e.target.value;
};

sizeRange.oninput = e => {
  uploadedImg.style.transform = `scale(${e.target.value})`;
};

flipBtn.onclick = () => {
  usingFrontCamera = !usingFrontCamera;
  startCamera();
};

lockBtn.onclick = () => {
  locked = !locked;
  uploadedImg.style.pointerEvents = locked ? 'none' : 'auto';
  lockBtn.textContent = locked ? "ğŸ”’ Ø§Ù„ØµÙˆØ±Ø© Ù…Ù‚ÙÙˆÙ„Ø©" : "Ù‚ÙÙ„ Ø§Ù„ØµÙˆØ±Ø©";
};
</script>

</body>
</html>
